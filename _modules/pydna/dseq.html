

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pydna.dseq &mdash; pydna 6.0.0a24.post17+b7b559bd66 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=7ab3649f" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=a051be83" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=6efefdf6"></script>
      <script src="../../_static/doctools.js?v=888ff710"></script>
      <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            pydna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Pydna</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example_gallery.html">Example gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pydna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
          <li class="breadcrumb-item"><a href="../pydna.html">pydna</a></li>
      <li class="breadcrumb-item active">pydna.dseq</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pydna.dseq</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># Copyright 2013-2023 by Bj√∂rn Johansson.  All rights reserved.</span>
<span class="c1"># This code is part of the Python-dna distribution and governed by its</span>
<span class="c1"># license.  Please see the LICENSE.txt file that should have been included</span>
<span class="c1"># as part of this package.</span>
<span class="sd">&quot;&quot;&quot;Provides the Dseq class for handling double stranded DNA sequences.</span>

<span class="sd">Dseq is a subclass of :class:`Bio.Seq.Seq`. The Dseq class</span>
<span class="sd">is mostly useful as a part of the :class:`pydna.dseqrecord.Dseqrecord` class</span>
<span class="sd">which can hold more meta data.</span>

<span class="sd">The Dseq class support the notion of circular and linear DNA topology.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">_copy</span>
<span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">_itertools</span>
<span class="kn">import</span> <span class="nn">re</span> <span class="k">as</span> <span class="nn">_re</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="k">as</span> <span class="nn">_sys</span>
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">_math</span>

<span class="kn">from</span> <span class="nn">pydna.seq</span> <span class="kn">import</span> <span class="n">Seq</span> <span class="k">as</span> <span class="n">_Seq</span>
<span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">_translate_str</span><span class="p">,</span> <span class="n">_SeqAbstractBaseClass</span>

<span class="kn">from</span> <span class="nn">pydna._pretty</span> <span class="kn">import</span> <span class="n">pretty_str</span> <span class="k">as</span> <span class="n">_pretty_str</span>
<span class="kn">from</span> <span class="nn">seguid</span> <span class="kn">import</span> <span class="n">ldseguid</span> <span class="k">as</span> <span class="n">_ldseguid</span>
<span class="kn">from</span> <span class="nn">seguid</span> <span class="kn">import</span> <span class="n">cdseguid</span> <span class="k">as</span> <span class="n">_cdseguid</span>

<span class="kn">from</span> <span class="nn">pydna.utils</span> <span class="kn">import</span> <span class="n">rc</span> <span class="k">as</span> <span class="n">_rc</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span> <span class="kn">import</span> <span class="n">flatten</span> <span class="k">as</span> <span class="n">_flatten</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span> <span class="kn">import</span> <span class="n">cuts_overlap</span> <span class="k">as</span> <span class="n">_cuts_overlap</span>

<span class="kn">from</span> <span class="nn">pydna.common_sub_strings</span> <span class="kn">import</span> <span class="n">common_sub_strings</span> <span class="k">as</span> <span class="n">_common_sub_strings</span>
<span class="kn">from</span> <span class="nn">Bio.Restriction</span> <span class="kn">import</span> <span class="n">RestrictionBatch</span> <span class="k">as</span> <span class="n">_RestrictionBatch</span>
<span class="kn">from</span> <span class="nn">Bio.Restriction</span> <span class="kn">import</span> <span class="n">CommOnly</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TYPE_CHECKING</span><span class="p">,</span>
    <span class="n">List</span> <span class="k">as</span> <span class="n">_List</span><span class="p">,</span>
    <span class="n">Tuple</span> <span class="k">as</span> <span class="n">_Tuple</span><span class="p">,</span>
    <span class="n">Union</span> <span class="k">as</span> <span class="n">_Union</span><span class="p">,</span>
    <span class="n">TypeVar</span> <span class="k">as</span> <span class="n">_TypeVar</span><span class="p">,</span>
    <span class="n">Iterable</span> <span class="k">as</span> <span class="n">_Iterable</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">Bio.Restriction</span> <span class="kn">import</span> <span class="n">AbstractCut</span> <span class="k">as</span> <span class="n">_AbstractCut</span>


<span class="c1"># To represent any subclass of Dseq</span>
<span class="n">DseqType</span> <span class="o">=</span> <span class="n">_TypeVar</span><span class="p">(</span><span class="s2">&quot;DseqType&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s2">&quot;Dseq&quot;</span><span class="p">)</span>
<span class="n">EnzymesType</span> <span class="o">=</span> <span class="n">_TypeVar</span><span class="p">(</span><span class="s2">&quot;EnzymesType&quot;</span><span class="p">,</span> <span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="n">_Iterable</span><span class="p">[</span><span class="s2">&quot;_AbstractCut&quot;</span><span class="p">],</span> <span class="s2">&quot;_AbstractCut&quot;</span><span class="p">)</span>
<span class="n">CutSiteType</span> <span class="o">=</span> <span class="n">_Tuple</span><span class="p">[</span><span class="n">_Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">_Union</span><span class="p">[</span><span class="s2">&quot;_AbstractCut&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>


<div class="viewcode-block" id="Dseq"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq">[docs]</a><span class="k">class</span> <span class="nc">Dseq</span><span class="p">(</span><span class="n">_Seq</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dseq holds information for a double stranded DNA fragment.</span>

<span class="sd">    Dseq also holds information describing the topology of</span>
<span class="sd">    the DNA fragment (linear or circular).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    watson : str</span>
<span class="sd">        a string representing the watson (sense) DNA strand.</span>

<span class="sd">    crick : str, optional</span>
<span class="sd">        a string representing the crick (antisense) DNA strand.</span>

<span class="sd">    ovhg : int, optional</span>
<span class="sd">        A positive or negative number to describe the stagger between the</span>
<span class="sd">        watson and crick strands.</span>
<span class="sd">        see below for a detailed explanation.</span>

<span class="sd">    linear : bool, optional</span>
<span class="sd">        True indicates that sequence is linear, False that it is circular.</span>

<span class="sd">    circular : bool, optional</span>
<span class="sd">        True indicates that sequence is circular, False that it is linear.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Dseq is a subclass of the Biopython Seq object. It stores two</span>
<span class="sd">    strings representing the watson (sense) and crick(antisense) strands.</span>
<span class="sd">    two properties called linear and circular, and a numeric value ovhg</span>
<span class="sd">    (overhang) describing the stagger for the watson and crick strand</span>
<span class="sd">    in the 5&#39; end of the fragment.</span>

<span class="sd">    The most common usage is probably to create a Dseq object as a</span>
<span class="sd">    part of a Dseqrecord object (see :class:`pydna.dseqrecord.Dseqrecord`).</span>

<span class="sd">    There are three ways of creating a Dseq object directly listed below, but you can also</span>
<span class="sd">    use the function Dseq.from_full_sequence_and_overhangs() to create a Dseq:</span>

<span class="sd">    Only one argument (string):</span>

<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>

<span class="sd">    The given string will be interpreted as the watson strand of a</span>
<span class="sd">    blunt, linear double stranded sequence object. The crick strand</span>
<span class="sd">    is created automatically from the watson strand.</span>

<span class="sd">    Two arguments (string, string):</span>

<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;gggaaat&quot;,&quot;ttt&quot;)</span>
<span class="sd">    Dseq(-7)</span>
<span class="sd">    gggaaat</span>
<span class="sd">       ttt</span>

<span class="sd">    If both watson and crick are given, but not ovhg an attempt</span>
<span class="sd">    will be made to find the best annealing between the strands.</span>
<span class="sd">    There are limitations to this. For long fragments it is quite</span>
<span class="sd">    slow. The length of the annealing sequences have to be at least</span>
<span class="sd">    half the length of the shortest of the strands.</span>

<span class="sd">    Three arguments (string, string, ovhg=int):</span>

<span class="sd">    The ovhg parameter is an integer describing the length of the</span>
<span class="sd">    crick strand overhang in the 5&#39; end of the molecule.</span>

<span class="sd">    The ovhg parameter controls the stagger at the five prime end::</span>

<span class="sd">        dsDNA       overhang</span>

<span class="sd">          nnn...    2</span>
<span class="sd">        nnnnn...</span>

<span class="sd">         nnnn...    1</span>
<span class="sd">        nnnnn...</span>

<span class="sd">        nnnnn...    0</span>
<span class="sd">        nnnnn...</span>

<span class="sd">        nnnnn...   -1</span>
<span class="sd">         nnnn...</span>

<span class="sd">        nnnnn...   -2</span>
<span class="sd">          nnn...</span>

<span class="sd">    Example of creating Dseq objects with different amounts of stagger:</span>

<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;, crick=&quot;actta&quot;, ovhg=-2)</span>
<span class="sd">    Dseq(-7)</span>
<span class="sd">    agt</span>
<span class="sd">      attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=-1)</span>
<span class="sd">    Dseq(-6)</span>
<span class="sd">    agt</span>
<span class="sd">     attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=0)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">    agt</span>
<span class="sd">    attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=1)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">     agt</span>
<span class="sd">    attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=2)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">      agt</span>
<span class="sd">    attca</span>

<span class="sd">    If the ovhg parameter is specified a crick strand also</span>
<span class="sd">    needs to be supplied, otherwise an exception is raised.</span>

<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;, ovhg=2)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">      File &quot;/usr/local/lib/python2.7/dist-packages/pydna_/dsdna.py&quot;, line 169, in __init__</span>
<span class="sd">        else:</span>
<span class="sd">    ValueError: ovhg defined without crick strand!</span>


<span class="sd">    The shape of the fragment is set by circular = True, False</span>

<span class="sd">    Note that both ends of the DNA fragment has to be compatible to set</span>
<span class="sd">    circular = True.</span>


<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=0)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=1)</span>
<span class="sd">    Dseq(-4)</span>
<span class="sd">     aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=-1)</span>
<span class="sd">    Dseq(-4)</span>
<span class="sd">    aaa</span>
<span class="sd">     ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;, &quot;ttt&quot;, circular = True , ovhg=0)</span>
<span class="sd">    Dseq(o3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>

<span class="sd">    &gt;&gt;&gt; a=Dseq(&quot;tttcccc&quot;,&quot;aaacccc&quot;)</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    Dseq(-11)</span>
<span class="sd">        tttcccc</span>
<span class="sd">    ccccaaa</span>
<span class="sd">    &gt;&gt;&gt; a.ovhg</span>
<span class="sd">    4</span>

<span class="sd">    &gt;&gt;&gt; b=Dseq(&quot;ccccttt&quot;,&quot;ccccaaa&quot;)</span>
<span class="sd">    &gt;&gt;&gt; b</span>
<span class="sd">    Dseq(-11)</span>
<span class="sd">    ccccttt</span>
<span class="sd">        aaacccc</span>
<span class="sd">    &gt;&gt;&gt; b.ovhg</span>
<span class="sd">    -4</span>
<span class="sd">    &gt;&gt;&gt;</span>

<span class="sd">    Coercing to string</span>

<span class="sd">    &gt;&gt;&gt; str(a)</span>
<span class="sd">    &#39;ggggtttcccc&#39;</span>

<span class="sd">    A Dseq object can be longer that either the watson or crick strands.</span>

<span class="sd">    ::</span>

<span class="sd">        &lt;-- length --&gt;</span>
<span class="sd">        GATCCTTT</span>
<span class="sd">             AAAGCCTAG</span>

<span class="sd">        &lt;-- length --&gt;</span>
<span class="sd">              GATCCTTT</span>
<span class="sd">        AAAGCCCTA</span>

<span class="sd">    The slicing of a linear Dseq object works mostly as it does for a string.</span>

<span class="sd">    &gt;&gt;&gt; s=&quot;ggatcc&quot;</span>
<span class="sd">    &gt;&gt;&gt; s[2:3]</span>
<span class="sd">    &#39;a&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[2:4]</span>
<span class="sd">    &#39;at&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[2:4:-1]</span>
<span class="sd">    &#39;&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[::2]</span>
<span class="sd">    &#39;gac&#39;</span>
<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, circular=False)</span>
<span class="sd">    &gt;&gt;&gt; d[2:3]</span>
<span class="sd">    Dseq(-1)</span>
<span class="sd">    a</span>
<span class="sd">    t</span>
<span class="sd">    &gt;&gt;&gt; d[2:4]</span>
<span class="sd">    Dseq(-2)</span>
<span class="sd">    at</span>
<span class="sd">    ta</span>
<span class="sd">    &gt;&gt;&gt; d[2:4:-1]</span>
<span class="sd">    Dseq(-0)</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    &gt;&gt;&gt; d[::2]</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    gac</span>
<span class="sd">    ctg</span>


<span class="sd">    The slicing of a circular Dseq object has a slightly different meaning.</span>


<span class="sd">    &gt;&gt;&gt; s=&quot;ggAtCc&quot;</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, circular=True)</span>
<span class="sd">    &gt;&gt;&gt; d</span>
<span class="sd">    Dseq(o6)</span>
<span class="sd">    ggAtCc</span>
<span class="sd">    ccTaGg</span>
<span class="sd">    &gt;&gt;&gt; d[4:3]</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">    CcggA</span>
<span class="sd">    GgccT</span>


<span class="sd">    The slice [X:X] produces an empty slice for a string, while this</span>
<span class="sd">    will return the linearized sequence starting at X:</span>

<span class="sd">    &gt;&gt;&gt; s=&quot;ggatcc&quot;</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, circular=True)</span>
<span class="sd">    &gt;&gt;&gt; d</span>
<span class="sd">    Dseq(o6)</span>
<span class="sd">    ggatcc</span>
<span class="sd">    cctagg</span>
<span class="sd">    &gt;&gt;&gt; d[3:3]</span>
<span class="sd">    Dseq(-6)</span>
<span class="sd">    tccgga</span>
<span class="sd">    aggcct</span>
<span class="sd">    &gt;&gt;&gt;</span>


<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    pydna.dseqrecord.Dseqrecord</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">trunc</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">watson</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
        <span class="n">crick</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ovhg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">watson</span> <span class="o">=</span> <span class="n">watson</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">crick</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">crick</span> <span class="o">=</span> <span class="n">crick</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">crick</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ovhg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ovhg defined without crick strand!&quot;</span><span class="p">)</span>
            <span class="n">crick</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
            <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># crick strand given</span>
            <span class="k">if</span> <span class="n">ovhg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># ovhg not given</span>
                <span class="n">olaps</span> <span class="o">=</span> <span class="n">_common_sub_strings</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">_math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">))</span> <span class="o">/</span> <span class="n">_math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">olaps</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not anneal the two strands.&quot;</span> <span class="s2">&quot; Please provide ovhg value&quot;</span><span class="p">)</span>

                <span class="c1"># We extract the positions and length of the first (longest) overlap, since</span>
                <span class="c1"># common_sub_strings sorts the overlaps by length.</span>
                <span class="n">pos_watson</span><span class="p">,</span> <span class="n">pos_crick</span><span class="p">,</span> <span class="n">longest_olap_length</span> <span class="o">=</span> <span class="n">olaps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="c1"># We see if there is another overlap of the same length</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">olap</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">longest_olap_length</span> <span class="k">for</span> <span class="n">olap</span> <span class="ow">in</span> <span class="n">olaps</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;More than one way of annealing the&quot;</span> <span class="s2">&quot; strands. Please provide ovhg value&quot;</span><span class="p">)</span>

                <span class="n">ovhg</span> <span class="o">=</span> <span class="n">pos_crick</span> <span class="o">-</span> <span class="n">pos_watson</span>

                <span class="n">sns</span> <span class="o">=</span> <span class="p">(</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
                <span class="n">asn</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
                    <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">_itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="n">sns</span><span class="p">,</span> <span class="n">asn</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)]),</span>
                    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># ovhg given</span>
                <span class="k">if</span> <span class="n">ovhg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
                            <span class="n">watson</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)]),</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                <span class="k">elif</span> <span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ovhg</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:])</span> <span class="o">+</span> <span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
                            <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:])</span> <span class="o">+</span> <span class="n">watson</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="n">ovhg</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)]),</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># ovhg &lt; 0</span>
                    <span class="k">if</span> <span class="o">-</span><span class="n">ovhg</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span>
                            <span class="n">watson</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span> <span class="o">-</span><span class="n">ovhg</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)]),</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crick</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">=</span> <span class="n">ovhg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>

<div class="viewcode-block" id="Dseq.quick"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.quick">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">quick</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">watson</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">crick</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Does not call __init__</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">crick</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">=</span> <span class="n">ovhg</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">ovhg</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">crick</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">cb</span><span class="p">[</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span> <span class="p">:])</span> <span class="o">+</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">cb</span><span class="p">[:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span> <span class="o">-</span> <span class="n">ovhg</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">wb</span><span class="p">))])</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Dseq.from_string"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.from_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">dna</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="c1"># linear=True,</span>
        <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Does not call __init__</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">crick</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">dna</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="c1"># obj._linear = linear</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">dna</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Dseq.from_representation"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.from_representation">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_representation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dsdna</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Does not call __init__</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="o">*</span><span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">ln</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">dsdna</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">ln</span><span class="p">]</span>
        <span class="n">ovhg</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()))</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">crick</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">crick</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">strip</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># obj._linear = True</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">ovhg</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">wb</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">crick</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">cb</span><span class="p">[</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span> <span class="p">:])</span> <span class="o">+</span> <span class="n">wb</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">cb</span><span class="p">[:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cb</span><span class="p">)</span> <span class="o">-</span> <span class="n">ovhg</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">wb</span><span class="p">))])</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Dseq.from_full_sequence_and_overhangs"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.from_full_sequence_and_overhangs">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">full_sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a linear Dseq object from a full sequence and the 3&#39; overhangs of each strand.</span>

<span class="sd">        The order of the parameters is like this because the 3&#39; overhang of the crick strand is the one</span>
<span class="sd">        on the left side of the sequence.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        full_sequence: str</span>
<span class="sd">            The full sequence of the Dseq object.</span>

<span class="sd">        crick_ovhg: int</span>
<span class="sd">            The overhang of the crick strand in the 3&#39; end. Equivalent to Dseq.ovhg.</span>

<span class="sd">        watson_ovhg: int</span>
<span class="sd">            The overhang of the watson strand in the 5&#39; end.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dseq</span>
<span class="sd">            A Dseq object.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; Dseq.from_full_sequence_and_overhangs(&#39;AAAAAA&#39;, crick_ovhg=2, watson_ovhg=2)</span>
<span class="sd">        Dseq(-6)</span>
<span class="sd">          AAAA</span>
<span class="sd">        TTTT</span>
<span class="sd">        &gt;&gt;&gt; Dseq.from_full_sequence_and_overhangs(&#39;AAAAAA&#39;, crick_ovhg=-2, watson_ovhg=2)</span>
<span class="sd">        Dseq(-6)</span>
<span class="sd">        AAAAAA</span>
<span class="sd">          TT</span>
<span class="sd">        &gt;&gt;&gt; Dseq.from_full_sequence_and_overhangs(&#39;AAAAAA&#39;, crick_ovhg=2, watson_ovhg=-2)</span>
<span class="sd">        Dseq(-6)</span>
<span class="sd">          AA</span>
<span class="sd">        TTTTTT</span>
<span class="sd">        &gt;&gt;&gt; Dseq.from_full_sequence_and_overhangs(&#39;AAAAAA&#39;, crick_ovhg=-2, watson_ovhg=-2)</span>
<span class="sd">        Dseq(-6)</span>
<span class="sd">        AAAA</span>
<span class="sd">          TTTT</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">full_sequence_rev</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Dseq</span><span class="p">(</span><span class="n">full_sequence</span><span class="p">)</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="n">full_sequence</span>
        <span class="n">crick</span> <span class="o">=</span> <span class="n">full_sequence_rev</span>

        <span class="c1"># If necessary, we trim the left side</span>
        <span class="k">if</span> <span class="n">crick_ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">crick</span> <span class="o">=</span> <span class="n">crick</span><span class="p">[:</span><span class="n">crick_ovhg</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">crick_ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">watson</span> <span class="o">=</span> <span class="n">watson</span><span class="p">[</span><span class="n">crick_ovhg</span><span class="p">:]</span>

        <span class="c1"># If necessary, we trim the right side</span>
        <span class="k">if</span> <span class="n">watson_ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">watson</span> <span class="o">=</span> <span class="n">watson</span><span class="p">[:</span><span class="n">watson_ovhg</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">watson_ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">crick</span> <span class="o">=</span> <span class="n">crick</span><span class="p">[</span><span class="n">watson_ovhg</span><span class="p">:]</span>

        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="o">=</span><span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="n">crick_ovhg</span><span class="p">)</span></div>

    <span class="c1"># @property</span>
    <span class="c1"># def ovhg(self):</span>
    <span class="c1">#     &quot;&quot;&quot;The ovhg property. This cannot be set directly, but is a</span>
    <span class="c1">#     consequence of how the watson and crick strands anneal to</span>
    <span class="c1">#     each other&quot;&quot;&quot;</span>
    <span class="c1">#     return self._ovhg</span>

    <span class="c1"># @property</span>
    <span class="c1"># def linear(self):</span>
    <span class="c1">#     &quot;&quot;&quot;The linear property can not be set directly.</span>
    <span class="c1">#     Use an empty slice [:] to create a linear object.&quot;&quot;&quot;</span>
    <span class="c1">#     return self._linear</span>

    <span class="c1"># @property</span>
    <span class="c1"># def circular(self):</span>
    <span class="c1">#     &quot;&quot;&quot;The circular property can not be set directly.</span>
    <span class="c1">#     Use :meth:`looped` to create a circular Dseq object&quot;&quot;&quot;</span>
    <span class="c1">#     return self._circular</span>

<div class="viewcode-block" id="Dseq.mw"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.mw">[docs]</a>    <span class="k">def</span> <span class="nf">mw</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method returns the molecular weight of the DNA molecule</span>
<span class="sd">        in g/mol. The following formula is used::</span>

<span class="sd">               MW = (A x 313.2) + (T x 304.2) +</span>
<span class="sd">                    (C x 289.2) + (G x 329.2) +</span>
<span class="sd">                    (N x 308.9) + 79.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nts</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="mf">313.2</span> <span class="o">*</span> <span class="n">nts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">304.2</span> <span class="o">*</span> <span class="n">nts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">289.2</span> <span class="o">*</span> <span class="n">nts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">329.2</span> <span class="o">*</span> <span class="n">nts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">308.9</span> <span class="o">*</span> <span class="n">nts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">79.0</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.upper"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.upper">[docs]</a>    <span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an upper case copy of the sequence.</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; my_seq = Dseq(&quot;aAa&quot;)</span>
<span class="sd">        &gt;&gt;&gt; my_seq</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aAa</span>
<span class="sd">        tTt</span>
<span class="sd">        &gt;&gt;&gt; my_seq.upper()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        AAA</span>
<span class="sd">        TTT</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dseq</span>
<span class="sd">            Dseq object in uppercase</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.lower</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
            <span class="n">ovhg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span>
            <span class="c1"># linear=self.linear,</span>
            <span class="n">circular</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.lower"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.lower">[docs]</a>    <span class="k">def</span> <span class="nf">lower</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a lower case copy of the sequence.</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; my_seq = Dseq(&quot;aAa&quot;)</span>
<span class="sd">        &gt;&gt;&gt; my_seq</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aAa</span>
<span class="sd">        tTt</span>
<span class="sd">        &gt;&gt;&gt; my_seq.lower()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dseq</span>
<span class="sd">            Dseq object in lowercase</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.upper</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="n">ovhg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span>
            <span class="c1"># linear=self.linear,</span>
            <span class="n">circular</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.find"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_SeqAbstractBaseClass</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">_sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method behaves like the python string method of the same name.</span>

<span class="sd">        Returns an integer, the index of the first occurrence of substring</span>
<span class="sd">        argument sub in the (sub)sequence given by [start:end].</span>

<span class="sd">        Returns -1 if the subsequence is NOT found.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        sub : string or Seq object</span>
<span class="sd">            a string or another Seq object to look for.</span>

<span class="sd">        start : int, optional</span>
<span class="sd">            slice start.</span>

<span class="sd">        end : int, optional</span>
<span class="sd">            slice end.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; seq = Dseq(&quot;atcgactgacgtgtt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        atcgactgacgtgtt</span>
<span class="sd">        tagctgactgcacaa</span>
<span class="sd">        &gt;&gt;&gt; seq.find(&quot;gac&quot;)</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; seq = Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=-2)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-7)</span>
<span class="sd">        agt</span>
<span class="sd">          attca</span>
<span class="sd">        &gt;&gt;&gt; seq.find(&quot;taa&quot;)</span>
<span class="sd">        2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">_pretty_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sl</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a subsequence. This method is used by the slice notation&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span>

            <span class="n">sns</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="n">sl</span><span class="p">]</span>
            <span class="n">asn</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">-</span><span class="n">x</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="n">sl</span><span class="p">]</span>

            <span class="n">ovhg</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()),</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">asn</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">asn</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())),</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                <span class="n">asn</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                <span class="n">ovhg</span><span class="o">=</span><span class="n">ovhg</span><span class="p">,</span>
                <span class="c1"># linear=True</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">sl</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">sl</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">sl</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="c1"># linear=True</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">stp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">stp</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span>

                <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[(</span><span class="n">start</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="p">::</span> <span class="n">stp</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span> <span class="p">(</span><span class="n">stop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="n">stp</span><span class="p">]</span>
                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="n">stop</span> <span class="p">::</span> <span class="n">stp</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="n">start</span> <span class="p">:</span> <span class="n">stp</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># , linear=True)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare to another Dseq object OR an object that implements</span>
<span class="sd">        watson, crick and ovhg properties. This comparison is case</span>
<span class="sd">        insensitive.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">same</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">other</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span>
                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">circular</span>
            <span class="p">)</span>
            <span class="c1"># Also test for alphabet ?</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">same</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">same</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a representation of the sequence, truncated if</span>
<span class="sd">        longer than 30 bp&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">trunc</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">hej</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)]</span>
                <span class="n">hej</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">hej</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="p">:]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span>
            <span class="k">elif</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="n">x</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="n">hej</span> <span class="o">-</span> <span class="n">y</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">L</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">L</span>

            <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">]</span>
            <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">x3</span><span class="p">:</span><span class="n">x4</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">e</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>

            <span class="k">return</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{klass}</span><span class="s2">(</span><span class="si">{top}{size}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">{a}{b}{c}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">{d}{e}{f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">klass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="n">top</span><span class="o">=</span><span class="p">{</span><span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">],</span>
                <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
                <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span>
                <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span>
                <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
                <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pretty_str</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}{}</span><span class="s2">)</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="p">{</span><span class="kc">False</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">],</span>
                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span>
                    <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">*</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>

<div class="viewcode-block" id="Dseq.reverse_complement"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.reverse_complement">[docs]</a>    <span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dseq object where watson and crick have switched places.</span>

<span class="sd">        This represents the same double stranded sequence.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; b=a.reverse_complement()</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcgatg</span>
<span class="sd">        ctagctac</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span>
            <span class="n">ovhg</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span>
            <span class="n">circular</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="n">rc</span> <span class="o">=</span> <span class="n">reverse_complement</span>  <span class="c1"># alias for reverse_complement</span>

<div class="viewcode-block" id="Dseq.shifted"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.shifted">[docs]</a>    <span class="k">def</span> <span class="nf">shifted</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shifted version of a circular Dseq object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA is not circular.&quot;</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">shift</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">shift</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[:</span><span class="n">shift</span><span class="p">])</span><span class="o">.</span><span class="n">looped</span><span class="p">()</span></div>

<div class="viewcode-block" id="Dseq.looped"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.looped">[docs]</a>    <span class="k">def</span> <span class="nf">looped</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Circularized Dseq object.</span>

<span class="sd">        This can only be done if the two ends are compatible,</span>
<span class="sd">        otherwise a TypeError is raised.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; a.looped()</span>
<span class="sd">        Dseq(o8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;t&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgat</span>
<span class="sd">         tagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;t&quot;).looped()</span>
<span class="sd">        Dseq(o7)</span>
<span class="sd">        catcgat</span>
<span class="sd">        gtagcta</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;a&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcga</span>
<span class="sd">          agctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;a&quot;).looped()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">          File &quot;/usr/local/lib/python2.7/dist-packages/pydna/dsdna.py&quot;, line 357, in looped</span>
<span class="sd">            if type5 == type3 and str(sticky5) == str(rc(sticky3)):</span>
<span class="sd">        TypeError: DNA cannot be circularized.</span>
<span class="sd">        5&#39; and 3&#39; sticky ends not compatible!</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">type5</span><span class="p">,</span> <span class="n">sticky5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>
        <span class="n">type3</span><span class="p">,</span> <span class="n">sticky3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">type5</span> <span class="o">==</span> <span class="n">type3</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">sticky5</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">sticky3</span><span class="p">)):</span>
            <span class="n">nseq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">],</span>
                <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># linear=False,</span>
                <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># assert len(nseq.crick) == len(nseq.watson)</span>
            <span class="k">return</span> <span class="n">nseq</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA cannot be circularized.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="s2">&quot;5&#39; and 3&#39; sticky ends not compatible!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.tolinear"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.tolinear">[docs]</a>    <span class="k">def</span> <span class="nf">tolinear</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a blunt, linear copy of a circular Dseq object. This can</span>
<span class="sd">        only be done if the Dseq object is circular, otherwise a</span>
<span class="sd">        TypeError is raised.</span>

<span class="sd">        This method is deprecated, use slicing instead. See example below.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;, circular=True)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(o8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; a[:]</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">warnings</span> <span class="k">as</span> <span class="nn">_warnings</span>
        <span class="kn">from</span> <span class="nn">pydna</span> <span class="kn">import</span> <span class="n">_PydnaDeprecationWarning</span>

        <span class="n">_warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;tolinear method is obsolete; &quot;</span> <span class="s2">&quot;please use obj[:] &quot;</span> <span class="s2">&quot;instead of obj.tolinear().&quot;</span><span class="p">,</span>
            <span class="n">_PydnaDeprecationWarning</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA is not circular.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">selfcopy</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">selfcopy</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">selfcopy</span>  <span class="c1"># self.__class__(self.watson, linear=True)</span></div>

<div class="viewcode-block" id="Dseq.five_prime_end"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.five_prime_end">[docs]</a>    <span class="k">def</span> <span class="nf">five_prime_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a tuple describing the structure of the 5&#39; end of</span>
<span class="sd">        the DNA fragment</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&#39;blunt&#39;, &#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">         aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&quot;3&#39;&quot;, &#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=-1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">        aaa</span>
<span class="sd">         ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&quot;5&#39;&quot;, &#39;a&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.three_prime_end</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;5&#39;&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;3&#39;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;blunt&quot;</span>
        <span class="k">return</span> <span class="n">type_</span><span class="p">,</span> <span class="n">sticky</span></div>

<div class="viewcode-block" id="Dseq.three_prime_end"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.three_prime_end">[docs]</a>    <span class="k">def</span> <span class="nf">three_prime_end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a tuple describing the structure of the 5&#39; end of</span>
<span class="sd">        the DNA fragment</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&#39;blunt&#39;, &#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">         aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&quot;3&#39;&quot;, &#39;a&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=-1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">        aaa</span>
<span class="sd">         ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&quot;5&#39;&quot;, &#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.five_prime_end</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ovhg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span>

        <span class="k">if</span> <span class="n">ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="n">ovhg</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;5&#39;&quot;</span>
        <span class="k">elif</span> <span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;3&#39;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;blunt&quot;</span>
        <span class="k">return</span> <span class="n">type_</span><span class="p">,</span> <span class="n">sticky</span></div>

<div class="viewcode-block" id="Dseq.watson_ovhg"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.watson_ovhg">[docs]</a>    <span class="k">def</span> <span class="nf">watson_ovhg</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the overhang of the watson strand at the three prime.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulates ligation between two DNA fragments.</span>

<span class="sd">        Add other Dseq object at the end of the sequence.</span>
<span class="sd">        Type error is raised if any of the points below are fulfilled:</span>

<span class="sd">        * one or more objects are circular</span>
<span class="sd">        * if three prime sticky end of self is not the same type</span>
<span class="sd">          (5&#39; or 3&#39;) as the sticky end of other</span>
<span class="sd">        * three prime sticky end of self complementary with five</span>
<span class="sd">          prime sticky end of other.</span>

<span class="sd">        Phosphorylation and dephosphorylation is not considered.</span>

<span class="sd">        DNA is allways presumed to have the necessary 5&#39; phospate</span>
<span class="sd">        group necessary for ligation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># test for circular DNA</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;circular DNA cannot be ligated!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;circular DNA cannot be ligated!&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">self_type</span><span class="p">,</span> <span class="n">self_tail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="n">other_type</span><span class="p">,</span> <span class="n">other_tail</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">self_type</span> <span class="o">==</span> <span class="n">other_type</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">self_tail</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">other_tail</span><span class="p">)):</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">crick</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;sticky ends not compatible!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">answer</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;TypeError: can&#39;t multiply Dseq by non-int of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">number</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">+=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">_fill_in_five_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">stuffer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">_rc</span><span class="p">(</span><span class="n">se</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                    <span class="n">stuffer</span> <span class="o">+=</span> <span class="n">n</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span> <span class="o">+</span> <span class="n">stuffer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">stuffer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_fill_in_three_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">stuffer</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">_rc</span><span class="p">(</span><span class="n">se</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                    <span class="n">stuffer</span> <span class="o">+=</span> <span class="n">n</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="n">stuffer</span>

<div class="viewcode-block" id="Dseq.fill_in"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.fill_in">[docs]</a>    <span class="k">def</span> <span class="nf">fill_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fill in of five prime protruding end with a DNA polymerase</span>
<span class="sd">        that has only DNA polymerase activity (such as exo-klenow [#]_)</span>
<span class="sd">        and any combination of A, G, C or T. Default are all four</span>
<span class="sd">        nucleotides together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        nucleotides : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.fill_in()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; b=Dseq(&quot;caaa&quot;, &quot;cttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaa</span>
<span class="sd">         tttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in()</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaag</span>
<span class="sd">        gtttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in(&quot;g&quot;)</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaag</span>
<span class="sd">        gtttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in(&quot;tac&quot;)</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaa</span>
<span class="sd">         tttc</span>
<span class="sd">        &gt;&gt;&gt; c=Dseq(&quot;aaac&quot;, &quot;tttg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">         aaac</span>
<span class="sd">        gttt</span>
<span class="sd">        &gt;&gt;&gt; c.fill_in()</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">         aaac</span>
<span class="sd">        gttt</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [#] http://en.wikipedia.org/wiki/Klenow_fragment#The_exo-_Klenow_fragment</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nucleotides</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nucleotides</span> <span class="o">=</span> <span class="s2">&quot;GATCRYWSMKHBVDN&quot;</span>

        <span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nucleotides</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">nucleotides</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_five_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_three_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.transcribe"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.transcribe">[docs]</a>    <span class="k">def</span> <span class="nf">transcribe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Seq</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_Seq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span><span class="o">.</span><span class="n">transcribe</span><span class="p">()</span></div>

<div class="viewcode-block" id="Dseq.translate"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.translate">[docs]</a>    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="s2">&quot;Standard&quot;</span><span class="p">,</span> <span class="n">stop_symbol</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">to_stop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Seq</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_Seq</span><span class="p">(</span><span class="n">_translate_str</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">table</span><span class="p">,</span> <span class="n">stop_symbol</span><span class="p">,</span> <span class="n">to_stop</span><span class="p">,</span> <span class="n">cds</span><span class="p">,</span> <span class="n">gap</span><span class="o">=</span><span class="n">gap</span><span class="p">))</span></div>

<div class="viewcode-block" id="Dseq.mung"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.mung">[docs]</a>    <span class="k">def</span> <span class="nf">mung</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulates treatment a nuclease with 5&#39;-3&#39; and 3&#39;-5&#39; single</span>
<span class="sd">        strand specific exonuclease activity (such as mung bean nuclease [#]_)</span>

<span class="sd">        ::</span>

<span class="sd">             ggatcc    -&gt;     gatcc</span>
<span class="sd">              ctaggg          ctagg</span>

<span class="sd">              ggatcc   -&gt;      ggatc</span>
<span class="sd">             tcctag            cctag</span>

<span class="sd">         &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">         &gt;&gt;&gt; b=Dseq(&quot;caaa&quot;, &quot;cttt&quot;)</span>
<span class="sd">         &gt;&gt;&gt; b</span>
<span class="sd">         Dseq(-5)</span>
<span class="sd">         caaa</span>
<span class="sd">          tttc</span>
<span class="sd">         &gt;&gt;&gt; b.mung()</span>
<span class="sd">         Dseq(-3)</span>
<span class="sd">         aaa</span>
<span class="sd">         ttt</span>
<span class="sd">         &gt;&gt;&gt; c=Dseq(&quot;aaac&quot;, &quot;tttg&quot;)</span>
<span class="sd">         &gt;&gt;&gt; c</span>
<span class="sd">         Dseq(-5)</span>
<span class="sd">          aaac</span>
<span class="sd">         gttt</span>
<span class="sd">         &gt;&gt;&gt; c.mung()</span>
<span class="sd">         Dseq(-3)</span>
<span class="sd">         aaa</span>
<span class="sd">         ttt</span>



<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [#] http://en.wikipedia.org/wiki/Mung_bean_nuclease</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)])</span></div>

<div class="viewcode-block" id="Dseq.T4"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.T4">[docs]</a>    <span class="k">def</span> <span class="nf">T4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fill in five prime protruding ends and chewing back</span>
<span class="sd">        three prime protruding ends by a DNA polymerase providing both</span>
<span class="sd">        5&#39;-3&#39; DNA polymerase activity and 3&#39;-5&#39; nuclease acitivty</span>
<span class="sd">        (such as T4 DNA polymerase). This can be done in presence of any</span>
<span class="sd">        combination of the four A, G, C or T. Removing one or more nucleotides</span>
<span class="sd">        can facilitate engineering of sticky ends. Default are all four nucleotides together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nucleotides : str</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;gatcgatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcgatc</span>
<span class="sd">        ctagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4()</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcgatc</span>
<span class="sd">        ctagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;t&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcgat</span>
<span class="sd">         tagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;a&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcga</span>
<span class="sd">          agctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;g&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcg</span>
<span class="sd">           gctag</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nucleotides</span><span class="p">:</span>
            <span class="n">nucleotides</span> <span class="o">=</span> <span class="s2">&quot;GATCRYWSMKHBVDN&quot;</span>
        <span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nucleotides</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">nucleotides</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_five_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">:</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">crick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">crick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">crick</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">ovhg</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ovhg</span>
        <span class="n">crick</span> <span class="o">=</span> <span class="n">crick</span><span class="p">[:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">crick</span><span class="p">:</span>
            <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_three_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">:</span>
                <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span> <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">watson</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="n">watson</span><span class="p">[:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span></div>

    <span class="n">t4</span> <span class="o">=</span> <span class="n">T4</span>  <span class="c1"># alias for the T4 method.</span>

<div class="viewcode-block" id="Dseq.exo1_front"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.exo1_front">[docs]</a>    <span class="k">def</span> <span class="nf">exo1_front</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;5&#39;-3&#39; resection at the start (left side) of the molecule.&quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">+=</span> <span class="n">n</span>
        <span class="n">d</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Dseq.exo1_end"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.exo1_end">[docs]</a>    <span class="k">def</span> <span class="nf">exo1_end</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DseqType</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;5&#39;-3&#39; resection at the end (right side) of the molecule.&quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">crick</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Dseq.no_cutters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.no_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">no_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestrictionBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enzymes in a RestrictionBatch not cutting sequence.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span> <span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span> <span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">sitelist</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.unique_cutters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.unique_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">unique_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestrictionBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enzymes in a RestrictionBatch cutting sequence once.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cutters</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span></div>

    <span class="n">once_cutters</span> <span class="o">=</span> <span class="n">unique_cutters</span>  <span class="c1"># alias for unique_cutters</span>

<div class="viewcode-block" id="Dseq.twice_cutters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.twice_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">twice_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestrictionBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enzymes in a RestrictionBatch cutting sequence twice.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cutters</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.n_cutters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.n_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">n_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestrictionBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enzymes in a RestrictionBatch cutting n times.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span> <span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span> <span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sitelist</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.cutters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.cutters">[docs]</a>    <span class="k">def</span> <span class="nf">cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">_RestrictionBatch</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestrictionBatch</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Enzymes in a RestrictionBatch cutting sequence at least once.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">batch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span> <span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span> <span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">sitelist</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.seguid"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.seguid">[docs]</a>    <span class="k">def</span> <span class="nf">seguid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;SEGUID checksum for the sequence.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">_cdseguid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">alphabet</span><span class="o">=</span><span class="s2">&quot;{DNA-extended}&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;docstring.&quot;&quot;&quot;</span>
            <span class="n">w</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="si">}{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">c</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">))</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="si">}{</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">_ldseguid</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s2">&quot;{DNA-extended}&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cs</span></div>

<div class="viewcode-block" id="Dseq.isblunt"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.isblunt">[docs]</a>    <span class="k">def</span> <span class="nf">isblunt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;isblunt.</span>

<span class="sd">        Return True if Dseq is linear and blunt and</span>
<span class="sd">        false if staggered or circular.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;gat&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        gat</span>
<span class="sd">        cta</span>
<span class="sd">        &gt;&gt;&gt; a.isblunt()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;gat&quot;, &quot;atcg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">         gat</span>
<span class="sd">        gcta</span>
<span class="sd">        &gt;&gt;&gt; a.isblunt()</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;gat&quot;, &quot;gatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">        gat</span>
<span class="sd">        ctag</span>
<span class="sd">        &gt;&gt;&gt; a.isblunt()</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;gat&quot;, circular=True)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(o3)</span>
<span class="sd">        gat</span>
<span class="sd">        cta</span>
<span class="sd">        &gt;&gt;&gt; a.isblunt()</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span></div>

<div class="viewcode-block" id="Dseq.cas9"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.cas9">[docs]</a>    <span class="k">def</span> <span class="nf">cas9</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RNA</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;docstring.&quot;&quot;&quot;</span>
        <span class="n">bRNA</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">RNA</span><span class="p">,</span> <span class="s2">&quot;ASCII&quot;</span><span class="p">)</span>
        <span class="n">slices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cuts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">_re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">bRNA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">):</span>
            <span class="n">cuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">+</span> <span class="mi">17</span><span class="p">)</span>
        <span class="n">cuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
        <span class="n">slices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cuts</span><span class="p">,</span> <span class="n">cuts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="k">return</span> <span class="n">slices</span></div>

<div class="viewcode-block" id="Dseq.terminal_transferase"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.terminal_transferase">[docs]</a>    <span class="k">def</span> <span class="nf">terminal_transferase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;docstring.&quot;&quot;&quot;</span>
        <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ovhg</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="n">nucleotides</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span> <span class="o">+</span> <span class="n">nucleotides</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.cut"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.cut">[docs]</a>    <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="o">*</span><span class="n">enzymes</span><span class="p">:</span> <span class="n">EnzymesType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="n">DseqType</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of linear Dseq fragments produced in the digestion.</span>
<span class="sd">        If there are no cuts, an empty list is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        enzymes : enzyme object or iterable of such objects</span>
<span class="sd">            A Bio.Restriction.XXX restriction objects or iterable.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        frags : list</span>
<span class="sd">            list of Dseq objects formed by the digestion</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; seq=Dseq(&quot;ggatccnnngaattc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        ggatccnnngaattc</span>
<span class="sd">        cctaggnnncttaag</span>
<span class="sd">        &gt;&gt;&gt; from Bio.Restriction import BamHI,EcoRI</span>
<span class="sd">        &gt;&gt;&gt; type(seq.cut(BamHI))</span>
<span class="sd">        &lt;class &#39;tuple&#39;&gt;</span>
<span class="sd">        &gt;&gt;&gt; for frag in seq.cut(BamHI): print(repr(frag))</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        g</span>
<span class="sd">        cctag</span>
<span class="sd">        Dseq(-14)</span>
<span class="sd">        gatccnnngaattc</span>
<span class="sd">            gnnncttaag</span>
<span class="sd">        &gt;&gt;&gt; seq.cut(EcoRI, BamHI) ==  seq.cut(BamHI, EcoRI)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a,b,c = seq.cut(EcoRI, BamHI)</span>
<span class="sd">        &gt;&gt;&gt; a+b+c</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        ggatccnnngaattc</span>
<span class="sd">        cctaggnnncttaag</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cutsites</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cutsites</span><span class="p">(</span><span class="o">*</span><span class="n">enzymes</span><span class="p">)</span>
        <span class="n">cutsite_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cutsite_pairs</span><span class="p">(</span><span class="n">cutsites</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply_cut</span><span class="p">(</span><span class="o">*</span><span class="n">cs</span><span class="p">)</span> <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">cutsite_pairs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.cutsite_is_valid"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.cutsite_is_valid">[docs]</a>    <span class="k">def</span> <span class="nf">cutsite_is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutsite</span><span class="p">:</span> <span class="n">CutSiteType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns False if:</span>
<span class="sd">        - Cut positions fall outside the sequence (could be moved to Biopython)</span>
<span class="sd">        - Overhang is not double stranded</span>
<span class="sd">        - Recognition site is not double stranded or is outside the sequence</span>
<span class="sd">        - For enzymes that cut twice, it checks that at least one possibility is valid</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">cutsite</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;cutsite is None&quot;</span>

        <span class="n">enz</span> <span class="o">=</span> <span class="n">cutsite</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cut_parameters</span><span class="p">(</span><span class="n">cutsite</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># The cut positions fall within the sequence</span>
        <span class="c1"># This could go into Biopython</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="ow">and</span> <span class="n">crick</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">crick</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># The overhang is double stranded</span>
        <span class="n">overhang_dseq</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">watson</span><span class="p">:</span><span class="n">crick</span><span class="p">]</span> <span class="k">if</span> <span class="n">ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="p">[</span><span class="n">crick</span><span class="p">:</span><span class="n">watson</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">overhang_dseq</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">overhang_dseq</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># The recognition site is double stranded and within the sequence</span>
        <span class="n">start_of_recognition_site</span> <span class="o">=</span> <span class="n">watson</span> <span class="o">-</span> <span class="n">enz</span><span class="o">.</span><span class="n">fst5</span>
        <span class="k">if</span> <span class="n">start_of_recognition_site</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start_of_recognition_site</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">end_of_recognition_site</span> <span class="o">=</span> <span class="n">start_of_recognition_site</span> <span class="o">+</span> <span class="n">enz</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="n">end_of_recognition_site</span> <span class="o">%=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">recognition_site</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">start_of_recognition_site</span><span class="p">:</span><span class="n">end_of_recognition_site</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recognition_site</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">recognition_site</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">recognition_site</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">enz</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">enz</span><span class="o">.</span><span class="n">scd5</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># For enzymes that cut twice, this might be referring to the second one</span>
                <span class="n">start_of_recognition_site</span> <span class="o">=</span> <span class="n">watson</span> <span class="o">-</span> <span class="n">enz</span><span class="o">.</span><span class="n">scd5</span>
                <span class="k">if</span> <span class="n">start_of_recognition_site</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">start_of_recognition_site</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">end_of_recognition_site</span> <span class="o">=</span> <span class="n">start_of_recognition_site</span> <span class="o">+</span> <span class="n">enz</span><span class="o">.</span><span class="n">size</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
                    <span class="n">end_of_recognition_site</span> <span class="o">%=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">recognition_site</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">start_of_recognition_site</span><span class="p">:</span><span class="n">end_of_recognition_site</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recognition_site</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">recognition_site</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">recognition_site</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Dseq.get_cutsites"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.get_cutsites">[docs]</a>    <span class="k">def</span> <span class="nf">get_cutsites</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DseqType</span><span class="p">,</span> <span class="o">*</span><span class="n">enzymes</span><span class="p">:</span> <span class="n">EnzymesType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_List</span><span class="p">[</span><span class="n">CutSiteType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of cutsites, represented represented as `((cut_watson, ovhg), enz)`:</span>

<span class="sd">        - `cut_watson` is a positive integer contained in `[0,len(seq))`, where `seq` is the sequence</span>
<span class="sd">          that will be cut. It represents the position of the cut on the watson strand, using the full</span>
<span class="sd">          sequence as a reference. By &quot;full sequence&quot; I mean the one you would get from `str(Dseq)`.</span>
<span class="sd">        - `ovhg` is the overhang left after the cut. It has the same meaning as `ovhg` in</span>
<span class="sd">          the `Bio.Restriction` enzyme objects, or pydna&#39;s `Dseq` property.</span>
<span class="sd">        - `enz` is the enzyme object. It&#39;s not necessary to perform the cut, but can be</span>
<span class="sd">           used to keep track of which enzyme was used.</span>

<span class="sd">        Cuts are only returned if the recognition site and overhang are on the double-strand</span>
<span class="sd">        part of the sequence.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        enzymes : Union[_RestrictionBatch,list[_AbstractCut]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[tuple[tuple[int,int], _AbstractCut]]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from Bio.Restriction import EcoRI</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; seq = Dseq(&#39;AAGAATTCAAGAATTC&#39;)</span>
<span class="sd">        &gt;&gt;&gt; seq.get_cutsites(EcoRI)</span>
<span class="sd">        [((3, -4), EcoRI), ((11, -4), EcoRI)]</span>

<span class="sd">        `cut_watson` is defined with respect to the &quot;full sequence&quot;, not the</span>
<span class="sd">        watson strand:</span>

<span class="sd">        &gt;&gt;&gt; dseq = Dseq.from_full_sequence_and_overhangs(&#39;aaGAATTCaa&#39;, 1, 0)</span>
<span class="sd">        &gt;&gt;&gt; dseq</span>
<span class="sd">        Dseq(-10)</span>
<span class="sd">         aGAATTCaa</span>
<span class="sd">        ttCTTAAGtt</span>
<span class="sd">        &gt;&gt;&gt; dseq.get_cutsites([EcoRI])</span>
<span class="sd">        [((3, -4), EcoRI)]</span>

<span class="sd">        Cuts are only returned if the recognition site and overhang are on the double-strand</span>
<span class="sd">        part of the sequence.</span>

<span class="sd">        &gt;&gt;&gt; Dseq(&#39;GAATTC&#39;).get_cutsites([EcoRI])</span>
<span class="sd">        [((1, -4), EcoRI)]</span>
<span class="sd">        &gt;&gt;&gt; Dseq.from_full_sequence_and_overhangs(&#39;GAATTC&#39;, -1, 0).get_cutsites([EcoRI])</span>
<span class="sd">        []</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">enzymes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">enzymes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_RestrictionBatch</span><span class="p">):</span>
            <span class="c1"># argument is probably a RestrictionBatch</span>
            <span class="n">enzymes</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="n">enzymes</span> <span class="o">=</span> <span class="n">_flatten</span><span class="p">(</span><span class="n">enzymes</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">:</span>
            <span class="c1"># Positions of the cut on the watson strand. They are 1-based, so we subtract</span>
            <span class="c1"># 1 to get 0-based positions</span>
            <span class="n">cuts_watson</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">))]</span>

            <span class="n">out</span> <span class="o">+=</span> <span class="p">[((</span><span class="n">w</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">ovhg</span><span class="p">),</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">cuts_watson</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">cutsite</span> <span class="k">for</span> <span class="n">cutsite</span> <span class="ow">in</span> <span class="n">out</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cutsite_is_valid</span><span class="p">(</span><span class="n">cutsite</span><span class="p">)])</span></div>

<div class="viewcode-block" id="Dseq.left_end_position"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.left_end_position">[docs]</a>    <span class="k">def</span> <span class="nf">left_end_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The index in the full sequence of the watson and crick start positions.</span>

<span class="sd">        full sequence (str(self)) for all three cases is AAA</span>
<span class="sd">        ::</span>

<span class="sd">            AAA              AA               AAT</span>
<span class="sd">             TT             TTT               TTT</span>
<span class="sd">            Returns (0, 1)  Returns (1, 0)    Returns (0, 0)</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span></div>

<div class="viewcode-block" id="Dseq.right_end_position"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.right_end_position">[docs]</a>    <span class="k">def</span> <span class="nf">right_end_position</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The index in the full sequence of the watson and crick end positions.</span>

<span class="sd">        full sequence (str(self)) for all three cases is AAA</span>

<span class="sd">        ```</span>
<span class="sd">        AAA               AA                   AAA</span>
<span class="sd">        TT                TTT                  TTT</span>
<span class="sd">        Returns (3, 2)    Returns (2, 3)       Returns (3, 3)</span>
<span class="sd">        ```</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span></div>

<div class="viewcode-block" id="Dseq.get_cut_parameters"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.get_cut_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">get_cut_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">_Union</span><span class="p">[</span><span class="n">CutSiteType</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">is_left</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For a given cut expressed as ((cut_watson, ovhg), enz), returns</span>
<span class="sd">        a tuple (cut_watson, cut_crick, ovhg).</span>

<span class="sd">        - cut_watson: see get_cutsites docs</span>
<span class="sd">        - cut_crick: equivalent of cut_watson in the crick strand</span>
<span class="sd">        - ovhg: see get_cutsites docs</span>

<span class="sd">        The cut can be None if it represents the left or right end of the sequence.</span>
<span class="sd">        Then it will return the position of the watson and crick ends with respect</span>
<span class="sd">        to the &quot;full sequence&quot;. The `is_left` parameter is only used in this case.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">watson</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="n">cut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">crick</span> <span class="o">=</span> <span class="n">watson</span> <span class="o">-</span> <span class="n">ovhg</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
                <span class="n">crick</span> <span class="o">%=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span>

        <span class="k">assert</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">,</span> <span class="s2">&quot;Circular sequences should not have None cuts&quot;</span>

        <span class="k">if</span> <span class="n">is_left</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">left_end_position</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span>
        <span class="c1"># In the right end, the overhang does not matter</span>
        <span class="k">return</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">right_end_position</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson_ovhg</span><span class="p">()</span></div>

<div class="viewcode-block" id="Dseq.apply_cut"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.apply_cut">[docs]</a>    <span class="k">def</span> <span class="nf">apply_cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_cut</span><span class="p">:</span> <span class="n">CutSiteType</span><span class="p">,</span> <span class="n">right_cut</span><span class="p">:</span> <span class="n">CutSiteType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dseq&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extracts a subfragment of the sequence between two cuts.</span>

<span class="sd">        For more detail see the documentation of get_cutsite_pairs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left_cut : Union[tuple[tuple[int,int], _AbstractCut], None]</span>
<span class="sd">        right_cut: Union[tuple[tuple[int,int], _AbstractCut], None]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dseq</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from Bio.Restriction import EcoRI</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; dseq = Dseq(&#39;aaGAATTCaaGAATTCaa&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cutsites = dseq.get_cutsites([EcoRI])</span>
<span class="sd">        &gt;&gt;&gt; cutsites</span>
<span class="sd">        [((3, -4), EcoRI), ((11, -4), EcoRI)]</span>
<span class="sd">        &gt;&gt;&gt; p1, p2, p3 = dseq.get_cutsite_pairs(cutsites)</span>
<span class="sd">        &gt;&gt;&gt; p1</span>
<span class="sd">        (None, ((3, -4), EcoRI))</span>
<span class="sd">        &gt;&gt;&gt; dseq.apply_cut(*p1)</span>
<span class="sd">        Dseq(-7)</span>
<span class="sd">        aaG</span>
<span class="sd">        ttCTTAA</span>
<span class="sd">        &gt;&gt;&gt; p2</span>
<span class="sd">        (((3, -4), EcoRI), ((11, -4), EcoRI))</span>
<span class="sd">        &gt;&gt;&gt; dseq.apply_cut(*p2)</span>
<span class="sd">        Dseq(-12)</span>
<span class="sd">        AATTCaaG</span>
<span class="sd">            GttCTTAA</span>
<span class="sd">        &gt;&gt;&gt; p3</span>
<span class="sd">        (((11, -4), EcoRI), None)</span>
<span class="sd">        &gt;&gt;&gt; dseq.apply_cut(*p3)</span>
<span class="sd">        Dseq(-7)</span>
<span class="sd">        AATTCaa</span>
<span class="sd">            Gtt</span>

<span class="sd">        &gt;&gt;&gt; dseq = Dseq(&#39;TTCaaGAA&#39;, circular=True)</span>
<span class="sd">        &gt;&gt;&gt; cutsites = dseq.get_cutsites([EcoRI])</span>
<span class="sd">        &gt;&gt;&gt; cutsites</span>
<span class="sd">        [((6, -4), EcoRI)]</span>
<span class="sd">        &gt;&gt;&gt; pair = dseq.get_cutsite_pairs(cutsites)[0]</span>
<span class="sd">        &gt;&gt;&gt; pair</span>
<span class="sd">        (((6, -4), EcoRI), ((6, -4), EcoRI))</span>
<span class="sd">        &gt;&gt;&gt; dseq.apply_cut(*pair)</span>
<span class="sd">        Dseq(-12)</span>
<span class="sd">        AATTCaaG</span>
<span class="sd">            GttCTTAA</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_cuts_overlap</span><span class="p">(</span><span class="n">left_cut</span><span class="p">,</span> <span class="n">right_cut</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cuts by </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2"> overlap.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">left_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">right_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">left_watson</span><span class="p">,</span> <span class="n">left_crick</span><span class="p">,</span> <span class="n">ovhg_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cut_parameters</span><span class="p">(</span><span class="n">left_cut</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">right_watson</span><span class="p">,</span> <span class="n">right_crick</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cut_parameters</span><span class="p">(</span><span class="n">right_cut</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">left_watson</span><span class="p">:</span><span class="n">right_watson</span><span class="p">]),</span>
            <span class="c1"># The line below could be easier to understand as _rc(str(self[left_crick:right_crick])), but it does not preserve the case</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="n">right_crick</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="n">left_crick</span><span class="p">]),</span>
            <span class="n">ovhg</span><span class="o">=</span><span class="n">ovhg_left</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Dseq.get_cutsite_pairs"><a class="viewcode-back" href="../../modules/pydna_dseq.html#pydna.all.Dseq.get_cutsite_pairs">[docs]</a>    <span class="k">def</span> <span class="nf">get_cutsite_pairs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">cutsites</span><span class="p">:</span> <span class="n">_List</span><span class="p">[</span><span class="n">CutSiteType</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_List</span><span class="p">[</span><span class="n">_Tuple</span><span class="p">[</span><span class="n">_Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">CutSiteType</span><span class="p">],</span> <span class="n">_Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">CutSiteType</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns pairs of cutsites that render the edges of the resulting fragments.</span>

<span class="sd">        A fragment produced by restriction is represented by a tuple of length 2 that</span>
<span class="sd">        may contain cutsites or `None`:</span>

<span class="sd">            - Two cutsites: represents the extraction of a fragment between those two</span>
<span class="sd">              cutsites, in that orientation. To represent the opening of a circular</span>
<span class="sd">              molecule with a single cutsite, we put the same cutsite twice.</span>
<span class="sd">            - `None`, cutsite: represents the extraction of a fragment between the left</span>
<span class="sd">              edge of linear sequence and the cutsite.</span>
<span class="sd">            - cutsite, `None`: represents the extraction of a fragment between the cutsite</span>
<span class="sd">              and the right edge of a linear sequence.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cutsites : list[tuple[tuple[int,int], _AbstractCut]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list[tuple[tuple[tuple[int,int], _AbstractCut]|None],tuple[tuple[int,int], _AbstractCut]|None]</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from Bio.Restriction import EcoRI</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; dseq = Dseq(&#39;aaGAATTCaaGAATTCaa&#39;)</span>
<span class="sd">        &gt;&gt;&gt; cutsites = dseq.get_cutsites([EcoRI])</span>
<span class="sd">        &gt;&gt;&gt; cutsites</span>
<span class="sd">        [((3, -4), EcoRI), ((11, -4), EcoRI)]</span>
<span class="sd">        &gt;&gt;&gt; dseq.get_cutsite_pairs(cutsites)</span>
<span class="sd">        [(None, ((3, -4), EcoRI)), (((3, -4), EcoRI), ((11, -4), EcoRI)), (((11, -4), EcoRI), None)]</span>

<span class="sd">        &gt;&gt;&gt; dseq = Dseq(&#39;TTCaaGAA&#39;, circular=True)</span>
<span class="sd">        &gt;&gt;&gt; cutsites = dseq.get_cutsites([EcoRI])</span>
<span class="sd">        &gt;&gt;&gt; cutsites</span>
<span class="sd">        [((6, -4), EcoRI)]</span>
<span class="sd">        &gt;&gt;&gt; dseq.get_cutsite_pairs(cutsites)</span>
<span class="sd">        [(((6, -4), EcoRI), ((6, -4), EcoRI))]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cutsites</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="n">cutsites</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">cutsites</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Add the first cutsite at the end, for circular cuts</span>
            <span class="n">cutsites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cutsites</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">cutsites</span><span class="p">,</span> <span class="n">cutsites</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span> <span class="k">as</span> <span class="nn">_os</span>

    <span class="n">cached</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">_os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">doctest</span>

    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">ELLIPSIS</span><span class="p">)</span>
    <span class="n">_os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Bj√∂rn F. Johansson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>