

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Representing sequences in pydna &mdash; pydna 6.0.0a24.post17+b7b559bd66 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=7ab3649f" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=945798ad" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=6efefdf6"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            pydna
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Pydna</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_contents.html">Module contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example_gallery.html">Example gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pydna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Representing sequences in pydna</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/markdown_notebooks/Dseq.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="representing-sequences-in-pydna">
<h1>Representing sequences in pydna<a class="headerlink" href="#representing-sequences-in-pydna" title="Permalink to this heading"></a></h1>
<blockquote>
<div><p>Visit the full library documentation <a class="reference external" href="https://bjornfjohansson.github.io/pydna/">here</a></p>
</div></blockquote>
<a target="_blank" href="https://colab.research.google.com/github/BjornFJohansson/pydna/blob/dev_bjorn/docs/notebooks/Dseq.ipynb">
  <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/>
</a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># Install pydna (only when running on Colab)
import sys
if &#39;google.colab&#39; in sys.modules:
    %%capture
    # Install the current development version of pydna (comment to install pip version)
    !pip install git+https://github.com/BjornFJohansson/pydna@dev_bjorn
    # Install pip version instead (uncomment to install)
    # !pip install pydna

</pre></div>
</div>
<p>Pydna contains classes to represent double stranded DNA sequences that can:</p>
<ul class="simple">
<li><p>Be linear</p></li>
<li><p>Be circular</p></li>
<li><p>Contain overhangs (sticky ends).</p></li>
</ul>
<p>These sequences can be used to simulate molecular biology methods such as cloning and PCR. The main classes used to represent sequences are <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> and <code class="docutils literal notranslate"><span class="pre">Dseqrecord</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dseq</span></code> represents the sequence only. Think of it as a FASTA file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dseqrecord</span></code> can contain sequence features and other info such as publication, authors, etc. Think of it as a Genbank file.</p></li>
</ul>
<blockquote>
<div><p>NOTE: The <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> class is a subclass of biopython’s <code class="docutils literal notranslate"><span class="pre">Seq</span></code>, whose documentation can be found <a class="reference external" href="https://biopython.org/wiki/Seq">here</a>. <code class="docutils literal notranslate"><span class="pre">Dseqrecord</span></code> is a subclass of biopython’s <code class="docutils literal notranslate"><span class="pre">SeqRecord</span></code>, whose documentation can be found <a class="reference external" href="https://biopython.org/wiki/SeqRecord">here</a>.</p>
</div></blockquote>
<section id="dseq-class">
<h2>Dseq Class<a class="headerlink" href="#dseq-class" title="Permalink to this heading"></a></h2>
<p>We can create a <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object in different ways.</p>
<p>For a linear sequence without overhangs, we create a <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object passing a string with the sequence. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydna.dseq</span> <span class="kn">import</span> <span class="n">Dseq</span>
<span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatat&quot;</span><span class="p">)</span>
<span class="n">my_seq</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-5)
aatat
ttata
</pre></div>
</div>
<p>In the console representation above, there are three lines:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Dseq(-5)</span></code> indicates that the sequence is linear and has 5 basepairs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aatat</span></code>, the top / sense / watson strand, referred from now on as <strong>watson</strong> strand..</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ttata</span></code>, the bottom / anti-sense / crick strand, referred from now on as <strong>crick</strong> strand.</p></li>
</ol>
<p>Now, let’s create a circular sequence:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatat&quot;</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">my_seq</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(o5)
aatat
ttata
</pre></div>
</div>
<blockquote>
<div><p>Note how <code class="docutils literal notranslate"><span class="pre">o5</span></code> indicates that the sequence is circular and has 5 basepairs.</p>
</div></blockquote>
<p>One way to represent a linear sequence with overhangs is to instantiate <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> with the following arguments:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">watson</span></code> strand as a string in the 5’-3’ direction.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">crick</span></code> strand as a string in the 5’-3’ direction.</p></li>
<li><p>The 5’ overhang <code class="docutils literal notranslate"><span class="pre">ovhg</span></code> (overhang), which can be positive or negative, and represents the number of basepairs that the <code class="docutils literal notranslate"><span class="pre">watson</span></code> strand extends beyond the <code class="docutils literal notranslate"><span class="pre">crick</span></code> strand.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;actag&quot;</span><span class="p">,</span> <span class="s2">&quot;ctag&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-5)
actag
 gatc
</pre></div>
</div>
<blockquote>
<div><p>Note how the bottom strand is passed in the 5’-3’ direction, but it is represented in the 3’-5’ direction in the console output.</p>
</div></blockquote>
<p>If you omit the <code class="docutils literal notranslate"><span class="pre">ovhg</span></code> argument, pydna will try to find the value that makes the <code class="docutils literal notranslate"><span class="pre">watson</span></code> and <code class="docutils literal notranslate"><span class="pre">crick</span></code> strands complementary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;actag&quot;</span><span class="p">,</span> <span class="s2">&quot;ctag&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-5)
actag
 gatc
</pre></div>
</div>
<p>The best way to get a feeling for the meaning of <code class="docutils literal notranslate"><span class="pre">ovhg</span></code> is to visualise the possible scenarios as such:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dsDNA</span>       <span class="n">overhang</span>

  <span class="n">nnn</span><span class="o">...</span>    <span class="mi">2</span>
<span class="n">nnnnn</span><span class="o">...</span>

  <span class="n">nnnn</span><span class="o">...</span>   <span class="mi">1</span>
<span class="n">nnnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>    <span class="mi">0</span>
<span class="n">nnnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>   <span class="o">-</span><span class="mi">1</span>
  <span class="n">nnnn</span><span class="o">...</span>

<span class="n">nnnnn</span><span class="o">...</span>   <span class="o">-</span><span class="mi">2</span>
  <span class="n">nnn</span><span class="o">...</span>
</pre></div>
</div>
<p>Of note, the DNA sequence can be passed in both lower case and upper case, and are not restricted to the conventional ATCG nucleotides (E.g ), The class supports the IUPAC ambiguous nucleotide code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;Actag&quot;</span><span class="p">,</span> <span class="s2">&quot;Ctag&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-5)
Actag
 gatC
</pre></div>
</div>
<p>Another way to pass the overhangs is to use the <code class="docutils literal notranslate"><span class="pre">from_full_sequence_and_overhangs</span></code> classmethod, which only needs the <code class="docutils literal notranslate"><span class="pre">watson</span></code>/sense strand. This is useful you can only store the entire sequence (e.g. in a FASTA file), or if you want to specify overhangs on both sides of the double stranded DNA when you create the object.</p>
<p>Both the <code class="docutils literal notranslate"><span class="pre">watson_ovhg</span></code> and <code class="docutils literal notranslate"><span class="pre">crick_ovhg</span></code> can be passed following the same rules as above. Specifically, the <code class="docutils literal notranslate"><span class="pre">crick_ovhg</span></code> argument is identical to the conventional <code class="docutils literal notranslate"><span class="pre">ovhg</span></code> argument. The <code class="docutils literal notranslate"><span class="pre">watson_ovhg</span></code> argument is the <code class="docutils literal notranslate"><span class="pre">ovhg</span></code> argument applied to the reverse complementary sequence.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="s2">&quot;aaattaaa&quot;</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">my_seq</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-8)
aaatta
   aattt
</pre></div>
</div>
<p>A list of possible scenarios, applying positive and negative <code class="docutils literal notranslate"><span class="pre">crick_ovhg</span></code> and <code class="docutils literal notranslate"><span class="pre">watson_ovhg</span></code> to a <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object are visualised in the output of the code below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">crick_ovhg</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">watson_ovhg</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;watson_ovhg is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">watson_ovhg</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, crick_ovhg is &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crick_ovhg</span><span class="p">))</span>
        <span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="s2">&quot;aaattaaa&quot;</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">my_seq</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>watson_ovhg is -3, crick_ovhg is -2
Dseq(-8)
aaatt
  taattt

watson_ovhg is 3, crick_ovhg is -2
Dseq(-8)
aaattaaa
  taa

watson_ovhg is -3, crick_ovhg is 2
Dseq(-8)
  att
tttaattt

watson_ovhg is 3, crick_ovhg is 2
Dseq(-8)
  attaaa
tttaa
</pre></div>
</div>
<p>The drawing below can help visualize the meaning of the overhangs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="mi">5</span><span class="s1">&#39;( a)--( a)--( a)--(t)--(t)--(a)--( a)--( a)3&#39;</span>
<span class="mi">3</span><span class="s1">&#39;( a)--( a)--( a)--(t)--(t)--(a)--( a)--( a)5&#39;</span>

<span class="mi">5</span><span class="s1">&#39;( a)--( a)--( a)--(t)--(t)--(a)--(  )--(  )3&#39;</span>
<span class="mi">3</span><span class="s1">&#39;(  )--(  )--(  )--(t)--(t)--(a)--( a)--( a)5&#39;</span>
</pre></div>
</div>
<p>If you would like to check the overhangs for a <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object, it can be done by calling the methods <code class="docutils literal notranslate"><span class="pre">five_prime_end</span></code> and <code class="docutils literal notranslate"><span class="pre">three_prime_end</span></code> to show the 5’ and 3’ overhangs, respectively. An example of a <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object, and examples showing what the print-out of the methods looks like are demonstrated here:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatat&quot;</span><span class="p">,</span> <span class="s2">&quot;ttata&quot;</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_seq</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_seq</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_seq</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-7)
aatat
  atatt
(&quot;5&#39;&quot;, &#39;aa&#39;)
(&quot;5&#39;&quot;, &#39;tt&#39;)
</pre></div>
</div>
<p>If you now want to join your sequence’s sticky ends to make a circular sequence (i.e Plasmid), you can use the <code class="docutils literal notranslate"><span class="pre">looped</span></code> method. The sticky ends must be compatible to do so.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatat&quot;</span><span class="p">,</span> <span class="s2">&quot;ttata&quot;</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">my_seq</span><span class="o">.</span><span class="n">looped</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(o5)
aatat
ttata
</pre></div>
</div>
<p>If you want to change the circular origin of the sequence/plasmid, this can be easily done using the <code class="docutils literal notranslate"><span class="pre">shifted</span></code> method. This can be done by providing the number of bases between the original origin with the new origin:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatat&quot;</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">my_seq</span><span class="o">.</span><span class="n">shifted</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(o5)
tataa
atatt
</pre></div>
</div>
</section>
<section id="getitem-repr-and-str-methods">
<h2><strong>getitem</strong>, <strong>repr</strong>, and  <strong>str</strong> methods<a class="headerlink" href="#getitem-repr-and-str-methods" title="Permalink to this heading"></a></h2>
<section id="slicing-sequences-getitem">
<h3>Slicing sequences (<code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>)<a class="headerlink" href="#slicing-sequences-getitem" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> is the method that is called when you use the square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> after a python object. Below is an example of the builtin python <code class="docutils literal notranslate"><span class="pre">list</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;using square brackets:&#39;</span><span class="p">,</span> <span class="n">my_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;is the same as using __getitem__:&#39;</span><span class="p">,</span> <span class="n">my_list</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>using square brackets: [2, 3]
is the same as using __getitem__: [2, 3]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> method is modified in pydna to deal with <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> objects and returns a slice of the <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> object, defined by the a start value and a stop value, similarly to string indexing. In other words, <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> indexes <code class="docutils literal notranslate"><span class="pre">Dseq</span></code>. Note that ‘<strong>getitem</strong>’ (and, consequently, <code class="docutils literal notranslate"><span class="pre">[]</span></code>) uses zero-based indexing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatataa&quot;</span><span class="p">)</span>
<span class="n">my_seq</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-3)
tat
ata
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> respects overhangs.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="s2">&quot;aatataa&quot;</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">my_seq</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-5)
tata
atatt
</pre></div>
</div>
<p>Note that index zero corresponds to the leftmost base of the sequence, which might not necessarily be on the <code class="docutils literal notranslate"><span class="pre">watson</span></code> strand. Let’s create a sequence that has an overhang on the left side.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_with_overhangs</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="s2">&quot;aatacgttcc&quot;</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sequence_with_overhangs</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-10)
   acgttcc
ttatgcaagg
</pre></div>
</div>
<p>When we index starting from <code class="docutils literal notranslate"><span class="pre">2</span></code>, we don’t start counting on the watson, but on the crick strand since it is the leftmost one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_with_overhangs</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-8)
 acgt
atgcaagg
</pre></div>
</div>
<section id="slicing-circular-sequences">
<h4>Slicing circular sequences<a class="headerlink" href="#slicing-circular-sequences" title="Permalink to this heading"></a></h4>
<p>When slicing circular <code class="docutils literal notranslate"><span class="pre">Dseq</span></code> objects we get linear sequences.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">circular_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;aatctaa&quot;</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">circular_seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-4)
atct
taga
</pre></div>
</div>
<p>We can slice circular sequences across the origin (where index is zero) if the first index is bigger than the second index. This is demonstrated in the example below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">circular_seq</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-4)
aaaa
tttt
</pre></div>
</div>
</section>
</section>
<section id="printing-sequences-to-the-console-repr-and-str">
<h3>Printing sequences to the console: <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> and <code class="docutils literal notranslate"><span class="pre">__str__</span></code><a class="headerlink" href="#printing-sequences-to-the-console-repr-and-str" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">__repr__</span></code> and <code class="docutils literal notranslate"><span class="pre">__str__</span></code> are methods present in all python classes that return a string representation of an object. <code class="docutils literal notranslate"><span class="pre">__str__</span></code> is called by the <code class="docutils literal notranslate"><span class="pre">print</span></code> function, and <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> is used by the console or notebook output when the object is not assigned to a variable. Below is an example with a <code class="docutils literal notranslate"><span class="pre">date</span></code> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">my_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; print statement:&#39;</span><span class="p">,</span> <span class="n">my_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; repr:&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">my_date</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; repr from class method:&#39;</span><span class="p">,</span> <span class="n">my_date</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; console output:&#39;</span><span class="p">)</span>
<span class="n">my_date</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; print statement: 2023-08-15
&gt; repr: datetime.date(2023, 8, 15)
&gt; repr from class method: datetime.date(2023, 8, 15)

&gt; console output:





datetime.date(2023, 8, 15)
</pre></div>
</div>
<p>In a similar way, <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> and <code class="docutils literal notranslate"><span class="pre">__str__</span></code> methods are used by pydna to represent sequences as strings for different purposes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__repr__</span></code> is used to make a figure-like representation that shows both strands and the overhangs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__str__</span></code> is used to return the entire sequence as a string of characters (from the left-most to the right-most base of both strands), the way we would store it in a FASTA file.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_seq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_full_sequence_and_overhangs</span><span class="p">(</span><span class="s2">&quot;aaattaaa&quot;</span><span class="p">,</span> <span class="n">crick_ovhg</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">watson_ovhg</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; figure-like representation:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_seq</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt; string representation:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">my_seq</span><span class="p">)</span>

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&gt; figure-like representation:
 Dseq(-8)
aaatta
   aattt

&gt; string representation:
 aaattaaa
</pre></div>
</div>
<p>Note that on the string representation, the bases correspond to the entire sequence provided, even when they are only present on either the <code class="docutils literal notranslate"><span class="pre">watson</span></code> or <code class="docutils literal notranslate"><span class="pre">crick</span></code> strand. In the example above, the last two <code class="docutils literal notranslate"><span class="pre">aa</span></code> bases are missing from the <code class="docutils literal notranslate"><span class="pre">watson</span></code> strand,  and that only the <code class="docutils literal notranslate"><span class="pre">crick</span></code> strand has them.</p>
</section>
</section>
<section id="edge-cases">
<h2>Edge cases<a class="headerlink" href="#edge-cases" title="Permalink to this heading"></a></h2>
<p>You can create arbitrary double-stranded sequences that are not complementary if you specify both strands and an overhang, but you won’t be able to use them for molecular biology simulations. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;xxxx&quot;</span><span class="p">,</span> <span class="s2">&quot;atat&quot;</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Dseq(-6)
  xxxx
tata
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Björn F. Johansson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>